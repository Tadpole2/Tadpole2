===== 帮助 =====
man more/less/tail		:帮助(外国版)
指令 --help				:帮助(中国版)
yum						:在线安装
rz						:上传
sz						:下载
scp						:远程上传
./						:安装
./nginx -s stop			:停止服务
df -lh					:硬盘存储
du -h --max-depth=1		:查询文件夹大小

===== 安装方式 =====
源码安装				:编译后 执行make install命令安装
安装包安装
yum安装					:在线安装

===== 常用命令 =====
clear					:清屏
ctrl+c 或 q				:退出
pwd						:显示当前所在目录
touch 文件名			:创建一个空文件
wget 链接				:下载资源

===== cd命令 =====
cd / 					:进入根目录
cd 目录名				:相对路径,进入当前目录下的某目录
cd /目录名				:绝对路径,进入根目录下的某目录
cd - 					:返回上一个操作的目录
cd ../					:返回上一层
cd ../../				:逐层返回

===== ls和ll命令 ======
ls 						:查看所有目录名称
ll						:查看所有目录的详情
ll -h					:友好显示文件大小,带有单位 如:kb,mb
特别命令: ls -l 相当于 ll

===== mkdir创建目录命令 =====
mkdir 目录名			:根据目录名创建目录
mkdir -p				:级联创建目录

===== rmdir删除目录命令 =====
rmdir 目录名			:根据目录名删除目录(有子目录或子文件不能被删除)
rmdir -p				:级联删除目录

===== rm删除文件命令 =====
rm 文件名				:删除文件(需要用户确认)
rm -f 文件名			:删除文件(不询问,直接删除)
rm -r 目录名或文件名	:递归删除目录(包括文件)或文件(需要用户确认)
rm -rf 目录名或文件名	:不询问递归删除
rm -rf ./*				:不询问递归删除当前目录下所有目录和文件
rm -rf /*				:系统自杀(不可操作)

===== cp复制文件命令 =====
cp 文件a 文件b			:将文件a复制为文件b,需要指定源文件名和目标文件名或目录
cp 文件 ../				:将文件复制到上一层目录中

===== mv移动文件命令 =====
mv 文件 ../				:将文件移动到上一层目录中
mv 文件a 文件b			将a文件重命名为b文件

===== 软连接 =====
ln -s 源文件 目标文件	:建立软连接
  -s 	: 进行软链结(symbolic link)
  -f 	: 链结时先将与 dist 同档名的档案删除
　-d 	: 允许系统管理者硬链结自己的目录
　-i 	: 在删除与 dist 同档名的档案时先进行询问
　-n 	: 在进行软连结时，将 dist 视为一般的档案
rm -rf  目标文件  		:删除软连接(注意不是rm -rf  目标文件/)

===== tar打包命令 =====
tar 文件或目录 			:把文件或目录打包成一个文件,但不做压缩
常用参数:
  -c	:创建一个新的tar文件
  -v	:显示运行过程的信息
  -f	:指定打包后的文件名
  -z	:调用gzip压缩命令进行压缩
  -t	:查看压缩文件的内容
  -x	:解开tar文件
tar -zcvf 压缩目录名或压缩文件名 需要压缩的文件
  例:tar -zcvf t.tar.gz * :压缩当前目录下所有文件,压缩后的文件名为t.tar.gz
tar -zxvf 压缩目录名或文件名 :解压tar包
tar -ztvf xxx.tar :查看tar包内的文件
  -- 如果此tar包没有被压缩,当解压时把z参数去掉
jar		:解压war包
unzip	:解压zip包

===== grep快速查找命令 =====
grep location nginx.conf --color -A5 -B5  查找字符串并且高亮显示、显示查找到的元素的前、后5行内容
ps -ef					:查看所有进程
ps -ef | grep java		:查看java的进程
ps -ef | grep tomcat	:查看tomcat的进程

===== 浏览文件 =====
cat						:输出文件所有内容
more					:从头逐步查看所有内容
less					:和more相似,但less可使用PgUp、PgOn键来控制
tail					:显示文件后几行的内容(可指定)

===== 定时任务 =====
crond 是linux下用来周期性的执行某种任务或等待处理某些事件的一个守护进程
crontab命令详解
-u user	:用来设定某个用户的crontab服务
file：file是命令文件的名字,表示将file做为crontab的任务列表文件并载入crontab.如果在命令行中没有指定这个文件,crontab命令将接受标准输入(键盘)上键入的命令,并将它们载入crontab.
-e		:编辑某个用户的crontab文件内容.如果不指定用户,则表示编辑当前用户的crontab文件.
-l		:显示某个用户的crontab文件内容,如果不指定用户,则表示显示当前用户的crontab文件内容.
-r		:从/var/spool/cron目录中删除某个用户的crontab文件,如果不指定用户,则默认删除当前用户的crontab文件.
-i		:在删除用户的crontab文件时给确认提示.
内容格式如下:
minute(0-59) hour(0-23) day(1-31) month(1-12) week(0-7) command(执行的命令)
定时删除几天前的文件命令格式:	/bin/find 对应目录 -mtime +天数 -name "文件名" -exec /bin/rm -rf {} \;
样例: 1 0 * * * /bin/echo > /data/apache-tomcat-7.0.56/logs/catalina.out;
/etc/init.d/crond reload 重新加载
/etc/init.d/crond restart 重新启动

===== 文件创建与编辑 =====
===== vi进入文件命令 =====
vi或vim					:编辑或查看文件内容
  三种模式:命令行,插入,底行模式
	切换到命令行模式	:按ESC键
	切换到插入模式		:按i或o或a键
	切换到底行模式		:按:(冒号)
  a 或 i 或 o			:进入insert模式
  按ESC,然后:wq			:编辑成功,保存并退出
  按ESC,然后:q!			:放弃更改并退出
  按ESC,然后:q			:直接退出编辑
===== 查找文件内容命令 =====
/						:查找文件内容,按n键查找下一个,按N键查找上一个
n						:搜索翻页(配合/使用)
shift + n				:反向搜索翻页(配合/使用)
===== 替换文件内容命令 =====
:s/old/new				:用new替换old，替换当前行的第一个匹配
:s/old/new/g 			:用new替换old，替换当前行的所有匹配
:%s/old/new 			:用new替换old，替换所有行的第一个匹配
:%s/old/new/g 			:用new替换old，替换整个文件的所有匹配
===== 移动命令 =====
shift+g					:移动到文件尾部
===== 显示行号命令 =====
:set nu					:显示文件内容的行号
===== 重定向输出>和>>命令 =====
文件a > 文件b			:将a文件中的内容定下输出到b文件中覆盖原有内容
文件a >> 文件b			:将a文件中的内容定下输出到b文件中追到到已有内容后

===== 管道 "|" 命令 =====
作用:将一个命令的输出用作另一个命令的输入
ls --help | more		:分页查询帮助信息
ps -ef | grep java		:查询名称中包含java的进程

===== && 命令执行控制 =====
作用:命令之间使用&&链接,实现逻辑与的功能,只有在左边的命令执行成功后才能继续执行下一个命令,只要其中有一个命令执行失败,它后面的命令将都不会继续执行

===== 网络通讯命令 =====
ifconfig				:显示网络设备
ifconfig 网卡名 up		:启用某某网卡
ifconfig 网卡名 down	:停用某某网卡
ping 链接				:探测链接是否畅通
netstat -an				:查看网络端口号
netstat -an | grep 端口号:查询端口号占有情况

===== 系统管理命令 =====
date					:显示当前系统时间
date -s "时间"			:设置系统时间
df -h					:友好显示磁盘大小信息
free -m					:以mb为单位显示内存使用状态

top						:任务管理器(管理执行中的程序)
  1						:查看几核(进入任务管理器按1)

ps -ef					:查看所有进程
kill 进程编号			:杀掉某进程
kill -9 进程编号		:强制杀死进程
du -h					:显示当前目录大小
who						:显示当前登入系统的用户信息
hostname				:查看当前主机名
  修改vi/etc/susconfig/network
uname					:显示系统信息
uname -a				:显示本机详细信息

===== 多用户 =====
useradd 用户名			:添加一个用户
useradd 用户名 -d /home/t1	:指定用户home目录
passwd 用户名			:为用户设置或修改密码
userdel 用户名			:删除用户(不会删除home目录)
userdel -r 用户名		:删除用户以及home目录
/etc/passwd				:用户文件

cat /etc/passwd
deploy:x:500:500::/home/deploy:/bin/bash
username:password:userId:groupId     :comment:home      :directory:shell
用户名  :密码    :用户id:用户所在组id:备注   :用户根目录:shell命令所在目录
x是密码段，表示没有设置密码

===== 用户组 =====
groupadd 组名			:创建一个组
groupmod -n 新组名 旧组名:更新组(-n <新群组名称>)
useradd 用户名 -g 组名	:创建用户指定组
groupdel 组名			:删除组(如果存在组用户需要先删除组用户)
/etc/group				:组所在文件夹

cat /etc/group
deploy:x:500:sftp
lp    :x         :  7:daemon:lp
用户组:用户组口令:GID:该用户组所包含的用户(user)
x是密码段，表示没有设置密码

===== id命令 =====
id 参数 用户名			:查看一个用户的UID和GID
===== su命令 =====
su 用户名				:切换到指定用户
su - 用户名				:切换到指定用户,并且将环境也切换到该用户的环境

===== 特殊文件 =====
/etc/passwd				:用户文件
/etc/shadow  			:密码文件
/etc/group  			:组信息文件
/etc/sysconfig/iptables	:防火墙文件
/etc/ssh/sshd_config	:SSH请求Linux系统相关配置信息

===== 文件权限 =====
-打头					:文件
d打头					:目录
所属用户U  同组G  其他O
r  read   可读   4
w  write  可写   2
x  excuse 可执行 1
主用户拥有某某权限,同组人拥有某某权限,其他人拥有某某权限

chmod	 				:文件和目录权限编辑(授权)
  754 文件名
  u+s 文件名
  u表示该档案的拥有者 g表示与该档案的拥有者属于同一个群体(group)者 o表示其他以外的人 a表示这三者皆是
　+表示增加权限 -表示取消权限 =表示唯一设定权限。
  r表示可读取 w表示可写入 x表示可执行 X表示只有当该档案是个子目录或者该档案已经被设定过为可执行
chown					:变更文件或目录的拥有者或所属群组
  chown 用户名:组名 文件名
  chown -R 用户名:组名 目录

===== 关机,重启 =====
shutdown -h now			:立刻关机
shutdown -h 5			:5分钟后关机
poweroff				:立刻关机
shutdown -r now			:立刻重启
shutdown -r 5			:5分钟后重启
reboot					:立刻重启

	====================
	======= 实战 =======
	====================
===== rpm命令 =====
解释:rpm全称是Redhat Package Manager,
  RPM有五种操作模式:安装 卸载 升级 查询和验证
---> 安装
rpm -i 文件名.rpm		:安装软件
rpm -iv 文件名.rpm		:安装过程中显示安装软件信息
rpm -ivh 文件名.rpm		:安装过程中显示安装软件信息以及安装进度
---> 查询
rpm -qa					:查询所有已安装的包
rpm -qa | grep java		:查看java是否安装成功
---> 卸载
rpm -e 文件名			:卸载软件包
---> 升级
rpm -Uvh 文件名.rpm		:升级软件包过程中显示软件信息以及升级进度
---> 验证
rpm -V 需要验证的包		:验证软件包
---> 其他附加命令 <---
 --force		:强制操作
 --requires		:显示该包的依赖关系
 --nodeps		:忽略依赖关系并继续操作
例:
rpm -e --nodeps 软件名	:忽略依赖关系卸载软件包
java -version  			:查看JDK版本信息

===== 重新加载环境变量 =====
source /etc/profile		:改变环境变量后需要重新加载环境变量

===== 查看服务是否启动 =====
service mysql status	:查看mysql服务的状态
service mysql start		:启动mysql服务
service mysql stop		:停止mysql服务

===== 启动tomcat服务器 =====
cd tomcat/bin/startup.sh:启动tomcat服务器
sh startup.sh			:启动tomcat服务器

===== 关闭防火墙 =====
service iptables stop		:关闭防火墙服务
service iptables start		:开启防火墙服务
vim /etc/sysconfig/iptables	:修改防火墙文件

lsof -i:8885 	:查看端口为8885的PID
kill -9 9001	:强制杀死PID为9001的进程
nohup java -jar dby-app-0.0.1.jar > /dev/null 2>&1 &	:运行jar包

===== SSHD相关 =====
/etc/ssh/sshd_config		:SSH请求Linux系统相关配置信息
/etc/init.d/sshd restart	:重启sshd服务
/etc/pam.d/system-auth		:设置登录失败几次过后多长时间才能再次登录

-- PermitRootLogin 属性
参数类别			是否允许ssh登陆		登录方式		交互shell
yes						允许			没有限制		没有限制
without-password		允许			除密码以外		没有限制
forced-commands-only	允许		仅允许使用密钥	仅允许已授权的命令
no						不允许			N/A				N/A

-- MaxAuthTries 属性
默认未设置,设置数字则表示为密码可以输错的次数

-- ClientAliveInterval 属性
ClientAliveInterval设置一个以秒记的时长,如果超过这么长时间没有收到客户端的任何数据,sshd将通过安全通道向客户端
发送一个”alive”消息，并等候应答。
默认值 0 表示不发送”alive”消息。这个选项仅对SSH-2有效。
-- ClientAliveCountMax 属性
在未收到任何客户端回应前最多允许发送多少个”alive”消息.默认值是 3.
到达这个上限后,sshd 将强制断开连接、关闭会话.
备注一: 以上两个命令要配合使用,总时间为两属性设置的值相乘的秒值
备注二: 去除配置文件中ClientAliveCountMax前的#号,设置一个以分记的时长,如果超过这么长时间,
sshd将强制断开连接,关闭会话(待验证)

===== 用户相关 =====
adduser	用户名		:添加一个用户(新增用户后一定要设置密码,不然无法登陆)
userdel 用户名		:删除一个用户
cut -d : -f 1 /etc/passwd	:查看所有用户
passwd				:修改密码(root权限回车后直接输入两次密码即可)
passwd 普通用户名	:修改密码(普通用户回车后输入旧密码后输入两次密码即可)
== 赋予root权限
方式一: 
修改 /etc/sudoers 文件，找到下面一行，在root下面添加一行，如下所示：
## Allow root to run any commands anywhere
root    ALL=(ALL)     ALL
用户名   ALL=(ALL)     ALL
方式二:
修改 /etc/sudoers 文件，找到下面一行，把前面的注释（#）去掉
## Allows people in group wheel to run all commands
%wheel    ALL=(ALL)    ALL
然后修改用户，使其属于root组（wheel），命令如下：
usermod -g root 用户名

usermod [options] user_name (usermod命令解释)
usermod 命令修改系统帐户文件来反映通过命令行指定的变化
选项(options)
	-a|--append		:把用户追加到某些组中，仅与-G选项一起使用 
	-c|--comment	:修改/etc/passwd文件第五段comment 
	-d|--home    	:修改用户的家目录通常和-m选项一起使用 
	-e|--expiredate :指定用户帐号禁用的日期，格式YY-MM-DD 
	-f|--inactive   :用户密码过期多少天后采用就禁用该帐号，0表示密码已过期就禁用帐号，-1表示禁用此功能，默认值是-1 
	-g|--gid     	:修改用户的gid，改组一定存在
	-G|--groups  	:把用户追加到某些组中，仅与-a选项一起使用 
	-l|--login   	:修改用户的登录名称 
	-L|--lock    	:锁定用户的密码 
	-m|--move-home  :修改用户的家目录通常和-d选项一起使用 
	-s|--shell   	:修改用户的shell 
	-u|--uid     	:修改用户的uid，该uid必须唯一 
	-U|--unlock  	:解锁用户的密码 
	
useradd [options] LOGIN
选项(Options)
	-b|--base-dir BASE_DIR		:设置基本路径作为用户的登录目录
	-c|--comment COMMENT		:对用户的注释
	-d|--home-dir HOME_DIR		:设置用户的登录目录
	-D|--defaults				:改变设置
	-e|--expiredate EXPIRE_DATE	:设置用户的有效期
	-f|--inactive INACTIVE		:用户过期后，让密码无效
	-g|--gid GROUP				:使用户只属于某个组
	-G|--groups GROUPS			:使用户加入某个组
	-h|--help					:帮助
	-k|--skel SKEL_DIR			:指定其他的skel目录
	-K|--key KEY=VALUE			:覆盖 /etc/login.defs 配置文件
	-m|--create-home			:自动创建登录目录
	-l							:不把用户加入到lastlog文件中
	-M							:不自动创建登录目录
	-r							:建立系统账号
	-o|--non-unique				:允许用户拥有相同的UID
	-p|--password PASSWORD		:为新用户使用加密密码
	-s|--shell SHELL			:登录时候的shell
	-u|--uid UID				:为新用户指定一个UID
	-Z|--selinux-user SEUSER	:use a specific SEUSER for the SELinux user mappinguseradd test

===== 日志记录 =====
清除登陆系统成功的记录
echo > /var/log/wtmp	:此文件默认打开时乱码，可查到ip等信息
last					:此时即查不到用户登录信息

清除最后一次登陆系统的记录
echo > /var/log/lastlog :此文件默认打开时乱码，可查到ip等信息
lastlog					:此时即查不到用户登录信息

清除登陆系统失败的记录
echo > /var/log/btmp	:此文件默认打开时乱码，可查到登陆失败信息
lastb					:查不到登陆失败信息

清除历史执行命令
history -c				:清空历史执行命令
history -w 				:立即写入命令到 ./.bash_history文件中
echo > ./.bash_history	:或清空用户目录下的这个文件即可

导入空历史记录
vi /root/history 			:新建记录文件
history -c					:清除记录 
history -r /root/history.txt:导入记录 
history						:查询导入结果	

======= find命令 ========
find ./ -type f								:查找文件
find ./ -type d								:查找目录
find ./ -name test							:查找名字为test的文件或目录
find ./ -regex .*so.*\.gz					:查找名字符合正则表达式的文件,注意前面的‘.*’(查找到的文件带有目录)
查找目录并列出目录下的文件(为找到的每一个目录单独执行ls命令，没有选项-print时文件列表前一行不会显示目录名称)
find ./ -type d -print -exec ls {} \;
查找目录并列出目录下的文件(为找到的每一个目录单独执行ls命令,执行命令前需要确认)
find ./ -type d -ok ls {} \;
查找目录并列出目录下的文件(将找到的目录添加到ls命令后一次执行，参数过长时会分多次执行)
find ./ -type d -exec ls {} +
find ./ -name \*.c							:查找文件名匹配*.c的文件
find ./ -name test -print -exec cat {} \;	:打印test文件名后，打印test文件的内容
find ./ -name test -exec cat {} \;			:不打印test文件名，只打印test文件的内容
find ./ -mtime -2							:查找文件更新日时在距现在时刻二天以内的文件
find ./ -mtime +2							:查找文件更新日时在距现在时刻二天以上的文件
find ./ -mtime 2							:查找文件更新日时在距现在时刻一天以上二天以内的文件
find ./ -mmin -2							:查找文件更新日时在距现在时刻二分以内的文件
find ./ -mmin +2							:查找文件更新日时在距现在时刻二分以上的文件
find ./ -mmin 2								:查找文件更新日时在距现在时刻一分以上二分以内的文件
find ./ -newer abc							:查找文件更新时间比文件abc的内容更新时间新的文件
find ./ -anewer abc							:查找文件访问时间比文件abc的内容更新时间新的文件
find ./ -empty								:查找空文件或空目录
find ./ -empty -type f -print -delete		:查找空文件并删除
find ./ -perm 664							:查找权限为644的文件或目录(需完全符合)
find ./ -perm -664							:查找用户/组权限为读写，其他用户权限为读(其他权限不限)的文件或目录
find ./ -perm /220							:查找用户有写权限或者组用户有写权限的文件或目录
find ./ -perm /u+w,g+w
find ./ -perm /u=w,g=w
find ./ -perm -u=r							:查找所有者权限有读权限的目录或文件
find ./ -perm -g=r							:查找用户组权限有读权限的目录或文件
find ./ -perm -o=r							:查找其它用户权限有读权限的目录或文件
find ./ -user lzj							:查找所有者为lzj的文件或目录
find ./ -group gname						:查找组名为gname的文件或目录
find ./ -nouser								:查找文件的用户ID不存在的文件
find ./ -nogroup							:查找文件的组ID不存在的文件
find ./ -executable \! -readable			:查找有执行权限但没有可读权限的文件
find ./ -size -10c							:查找文件size小于10个字节的文件或目录
find ./ -size 10c							:查找文件size等于10个字节的文件或目录
find ./ -size +10c							:查找文件size大于10个字节的文件或目录
find ./ -size -10k							:查找文件size小于10k的文件或目录
find ./ -size -10M							:查找文件size小于10M的文件或目录
find ./ -size -10G							:查找文件size小于10G的文件或目录

//***Linux下安装nginx***//
-- 第一步: 在线安装Nginx的依赖(命令如下)
	yum -y install gcc-c++  
	yum -y install pcre pcre-devel  
	yum -y install zlib zlib-devel  
	yum -y install openssl openssl―devel
	
-- 第二步: 创建压缩文件上传位置(命令如下)
	mkdir /src/nginx 	// 创建文件夹
	cd /src/nginx 		// 进入文件夹
	
-- 第三步: 下载或者上传压缩文件
	wget http://nginx.org/download/nginx-1.7.7.tar.gz 或 rz上传
	tar -xvf nginx-1.7.7.tar.gz	// 解压文件
	cd nginx-1.7.7				// 进入解压后文件
	
-- 注意点: (一般root用户属于DBA,所以操作一般给子用户,限制权限)
	#安装到/ucenter 
	mkdir -p /ucenter/soft/nginx
	
	pwd 查看此时所在文件夹应该是 /src/nginx/nginx-1.7.7	,如果是运行一下命令进行配置
	./configure --prefix=/ucenter/soft/nginx --user=ucenter --group=ucenter // 配置环境
	make			// 编译  
	make install	// 安装

-- 防火墙问题
	防火墙打开80端口
	service iptables stop //关闭防火墙(一般不这样做)

	/sbin/iptables -I INPUT -p tcp --dport 80 -j ACCEPT	// 添加端口号到防火墙
	/etc/rc.d/init.d/iptables save	// 保存配置
	/etc/init.d/iptables status
	
-- 切换用户
	cd /ucenter/	// 此时用户是root,要进行切换
	chowm ucenter:ucenter ./* -R	// 修改当前目录及子目录的用户为ucenter所属组为ucenter
	su -ucenter // 切换用户
	cd /soft/nginx/sbin/
	./nginx // 提示没有权限
	
	由于非root用户不能占用80端口所以使普通用户以root身份启动nginx。
	// 如何做
	exit	// 退出到root用户
	cd /ucenter/soft/nginx/sbin	
	chown root nginx	// 暂时改变nginx文件的所属
	chmod u+s nginx		// 授权
	su -ucenter // 切换用户
	cd /soft/nginx/sbin/
	./nginx // 已经拥有权限并运行
	
ps -ef|grep nginx	查询进程,有两个进程即可(成功)

./nginx -s stop         快速关闭Nginx，可能不保存相关信息，并迅速终止web服务。（quick exit）
./nginx -s quit         平稳关闭Nginx，保存相关信息，有安排的结束web服务。（graceful exit）
./nginx -s reload       因改变了Nginx相关配置，需要重新加载配置而重载。（changing configuration，start a new worker,quitting an old worker gracefully.)
./nginx -s reopen       重新打开日志文件。(reopenging log files)


在线安装SSHD服务 yum install -y openssh-server

在 Linux 上可用以下语句看了一下服务器的TCP状态(连接状态数量统计): 
netstat -n | awk '/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}' 